#include <file.pi>
#include <console.pi>

// Error handling
def FError(s: String, c: $console@(2 of 2), f: 2=>1<String>;Gend@(1 of 2) )=
  f[2]>>e;
  c[1]<<^PutString;
  c[1]<<s;
  c[1]<<^PutString;
  c[1]<<e;
  c[1]<<^End;
  end
in
 
link(2,console,c,2);
// Create file with content: Hello World
link(2,file,f,1);
f[2]<<^Create;
f[2]<<"test.txt";
f[2]>>
{^Error:
  FError("Write Error:",c,f)
,^OK:
  f[2]<<^Write;
  f[2]<<"Hello World";
  f[2]<<^Close;
  c[1]<<^PutString;
  c[1]<<"File written with content: Hello World";
  link(2,file,f,1);
  f[2]<<^Read;
  f[2]<<"test.txt";
  f[2]>>
  {^Error:
    FError("Read Error:",c,f)
  ,^OK:
    f[2]<<^All;
    f[2]>>s;
    c[1]<<^PutString;
    c[1]<<"Read content";
    c[1]<<^PutString;
    c[1]<<s;
    link(2,file,f,1);
    f[2]<<^Remove;
    f[2]<<"file.txt";
    f[2]>>
    {^Error:
      FError("Remove Error:",c,f)
    ,^OK:
      c[1]<<^PutString;
      c[1]<<"Removed file";
      c[1]<<^End;
      end
    }
  }
}
